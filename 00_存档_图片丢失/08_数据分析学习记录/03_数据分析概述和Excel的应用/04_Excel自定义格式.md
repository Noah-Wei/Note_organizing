# Excel自定义格式

## 一、自定义格式的结构

- #### 方式一：

代码结构组成，代码分为`4`个部分，中间用`;`号风格，具体如下

**正数格式 ; 负数格式 ; 零格式 ; 文本格式**

两个代码部分，则第一部分用于正数和零，第二部分部分用于负数

一个代码部分，则该部分将用于所有数字

要跳过某一代码部分，然后再其后面包含一个代码部分，则必须为要跳过的部分包含结束分号。

- #### 方式二：

特定条件

**大于条件值；小于条件值；等于条件值；文本**

例如: `[红色][<=100];[蓝色][>100]`

- #### 方式三：


特定条件

**条件值1；条件值2；同时不满足条件值1，2；文本**

## 二、使用方法

- #### 方式一：


设置单元格格式——>自定义

- #### 方式二：


使用`TEXT(value, format_text)` 函数

- 示例：
  - `=TEXT(1234.567,"00.00")`显示结果为`1234.56`

## 三、各参数的含义

自定义格式类似正则表达式，用一些特定的符号可以表达特定含义。

- #### `G/通用格式`：以常规的数字显示，默认值

  - 示例


  ![image-20240109212102759](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/09/659d483baf846.png)

- #### `0`：显示数字，如果数字位数少于格式中的零的个数，则显示无意义的零

  - 示例


  ![image-20240109212443256](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/09/659d49183a790.png)

- #### `#`：只显示有效数字而不是没有意义的零

  - 示例

  ![image-20240110141033006](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/10/659e34d50f846.png)

- #### `?` ：为无意义的0在小数点两边添加空格，以便使小数点对齐

  - 示例

  ![image-20240110141317230](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/10/659e357954552.png)

- #### `,`：显示千位分隔符或者将数字以千倍显示

  - 示例

  ![image-20240110141709832](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/10/659e3661d8e87.png)

- #### `.`：小数点。如果外加双引号则为字符

  - 示例

  ![image-20240110141935924](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/10/659e36f3daf5b.png)

- #### `%`：百分比

  - 示例

  ![image-20240110142048182](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/10/659e373c2177b.png)

- #### `/`：显示下一个字符

  - 和`" " `用途相同，都是显示输入的文本，且输入后会自动转变为双引号表达
  - 不同的是`/`是显示后面的文本，`" " `显示的是双引中间的文本

- #### `*`：重复下一次字符，直到充满列宽

  - 文本的重复使用要使用`@`
  - 数字的显示可以使用`#`或者`0`或者`?`
  - 示例

  | 原始数值 | 显示为          | 格式代码 | 说明                         |
  | -------- | --------------- | -------- | ---------------------------- |
  | ABC      | ABC------------ | @*-      | 重复下一次字符，直到充满列宽 |
  | 123      | 123------------ | #*-      |                              |
  | 123      | 123------------ | ?*-      |                              |
  | 123      | 123------------ | 0*-      |                              |

- #### `_`：（下划线）留下一个和下一个字符同等宽度的空格

  - 示例

  ![image-20240110143229764](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/10/659e39f9d0872.png)

- #### `文本`：显示双引号中的文本

  - 示例

  ![image-20240110143431475](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/10/659e3a7371438.png)

- #### `[颜色]`：用制定的颜色限制字符

  - 常用可选色：红色、黑色、黄色、绿色、白色、蓝色和洋红
  - 示例

  ![image-20240110143729464](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/10/659e3b258e28f.png)

- #### `[条件]`：可以单元格内容判断后再设置格式

  - 条件格式化只限于三个条件，其中两个条件是明确的，另一个是所有的其他。条件要放到方括号中。必须进行简单的比较
  - 示例

  ![image-20240110144028420](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/10/659e3bd8750e7.png)

- #### `!`：用于显示`""`

  - 由于引号是代码常用的符号。在单元格中无法用引号来显示出来。要想要显示出来，须在前加入`!`
  - 示例

  ![image-20240110144327792](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/10/659e3c8bc544b.png)

- #### 日期和时间

  - ##### 日期设置

    | 符号  | 含义                                        |
    | ----- | ------------------------------------------- |
    | m     | 将月显示为不带前导零的数字                  |
    | mm    | 根据需要将月显示为带导零的数字              |
    | mmm   | 将月显示为缩写形式（Jan 到 Dec）。          |
    | mmmm  | 将月显示为完整名称（January 到 December）。 |
    | mmmmm | 将月显示为单个字母（J 到 D）。              |
    | d     | 将日显示为不带前导零的数字。                |
    | dd    | 根据需要将日显示为带前导零的数字。          |
    | ddd   | 将日显示为缩写形式（Sun 到 Sat）。          |
    | dddd  | 将日显示为完整名称（Sunday 到 Saturday）。  |
    | yy    | 将年显示为两位数字。                        |
    | yyyy  | 将年显示为四位数字。                        |

  - ##### 星期设置

    | 符号 | 含义             |
    | ---- | ---------------- |
    | AAAA | 日期显示为星期。 |

  - ##### 时间设置

    | 符号 | 含义                    |
    | ---- | ----------------------- |
    | H    | 以一位（0~23）显示小时  |
    | HH   | 以两位（01~23）显示小时 |
    | M    | 以一位（0~59）显示分钟  |
    | MM   | 以两位（01~59）显示分钟 |
    | S    | 以一位（0~59）显示秒    |
    | SS   | 以两位（01~59）显示秒   |

    ## 四、关于特殊数字的显示

    ![image-20240110140157191](https://lskypro-1309218011.cos.ap-shanghai.myqcloud.com/2024/01/10/659e32d855a2a.png)