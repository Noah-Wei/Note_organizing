# æœåŠ¡å™¨ç«¯å£å·å…¨é¢æŒ‡å—

## ä¸€ã€ç«¯å£å·åŸºç¡€

- ç«¯å£å·èŒƒå›´ï¼š`0-65535`ï¼ˆå…± 65,536 ä¸ªï¼‰
- æ¯ä¸ªç«¯å£ç”¨äºæ ‡è¯†æ“ä½œç³»ç»Ÿä¸­è¿è¡Œçš„ä¸åŒæœåŠ¡

### ç«¯å£åˆ†ç±»

| ç±»åˆ«          | èŒƒå›´        | è¯´æ˜                       | ç¤ºä¾‹                     |
| ------------- | ----------- | -------------------------- | ------------------------ |
| çŸ¥åç«¯å£      | 0â€“1023      | ç³»ç»ŸæœåŠ¡ä½¿ç”¨ï¼Œéœ€ç®¡ç†å‘˜æƒé™ | HTTP(80)ã€SSH(22)        |
| æ³¨å†Œç«¯å£      | 1024â€“49151  | åº”ç”¨ç¨‹åºæ³¨å†Œä½¿ç”¨           | MySQL(3306)ã€Redis(6379) |
| åŠ¨æ€/ç§æœ‰ç«¯å£ | 49152â€“65535 | ä¸´æ—¶ç«¯å£æˆ–ç”¨æˆ·å®šä¹‰æœåŠ¡ä½¿ç”¨ | å®¢æˆ·ç«¯è¿æ¥ä½¿ç”¨çš„ç«¯å£     |

## äºŒã€å¸¸è§æœåŠ¡ç«¯å£è¯¦è§£

### 1. Web æœåŠ¡

| ç«¯å£ | åè®®  | åŠ å¯† | ç”¨é€”          | å®‰å…¨å»ºè®®         |
| ---- | ----- | ---- | ------------- | ---------------- |
| 80   | HTTP  | å¦   | æ™®é€šç½‘é¡µè®¿é—®  | æ¨èå‡çº§åˆ° HTTPS |
| 443  | HTTPS | æ˜¯   | åŠ å¯†ç½‘é¡µè®¿é—®  | æ¨èé»˜è®¤ä½¿ç”¨     |
| 8080 | HTTP  | å¦   | å¤‡ç”¨ Web ç«¯å£ | æµ‹è¯•æˆ–å¼€å‘ç”¨é€”   |
| 8443 | HTTPS | æ˜¯   | å¤‡ç”¨å®‰å…¨ç«¯å£  | å¯æ›¿ä»£ 443 ä½¿ç”¨  |

### 2. æ•°æ®åº“æœåŠ¡

| ç«¯å£  | æ•°æ®åº“     | é»˜è®¤ç”¨æˆ·   | å®‰å…¨å»ºè®®                  |
| ----- | ---------- | ---------- | ------------------------- |
| 3306  | MySQL      | root       | é™åˆ¶è®¿é—® IPã€ä¿®æ”¹é»˜è®¤ç«¯å£ |
| 5432  | PostgreSQL | postgres   | å¯ç”¨ SSL åŠ å¯†             |
| 27017 | MongoDB    | admin      | å¯ç”¨è®¿é—®æ§åˆ¶å’Œè®¤è¯æœºåˆ¶    |
| 6379  | Redis      | æ—          | è®¾ç½®å¯†ç ã€ç»‘å®šæœ¬åœ°åœ°å€    |
| 1521  | Oracle     | sys/system | å¯ç”¨å¤æ‚å¯†ç å’Œå®¡è®¡æ—¥å¿—    |

### 3. è¿œç¨‹ç®¡ç†

| ç«¯å£ | åè®® | é€‚ç”¨å¹³å°       | å®‰å…¨åŠ å›ºå»ºè®®                 |
| ---- | ---- | -------------- | ---------------------------- |
| 22   | SSH  | Linux/Unix     | ç¦ç”¨ root ç™»å½•ã€å¯ç”¨å¯†é’¥è®¤è¯ |
| 3389 | RDP  | Windows        | å¯ç”¨ NLAã€é™åˆ¶è®¿é—® IP        |
| 5900 | VNC  | è·¨å¹³å°è¿œç¨‹æ¡Œé¢ | ä½¿ç”¨ SSH éš§é“åŠ å¯†ä¼ è¾“        |

### 4. æ–‡ä»¶ä¼ è¾“

| ç«¯å£ | åè®®     | åŠ å¯† | æ¨èæ›¿ä»£æ–¹æ¡ˆ      |
| ---- | -------- | ---- | ----------------- |
| 21   | FTP      | å¦   | ä½¿ç”¨ SFTP(22)     |
| 22   | SFTP/SCP | æ˜¯   | é»˜è®¤æ¨èä½¿ç”¨      |
| 2049 | NFS      | å¦   | å»ºè®®é€šè¿‡ VPN ä½¿ç”¨ |

## ä¸‰ã€å®‰å…¨å®è·µæŒ‡å—

### 1. æœ€å°åŒ–å¼€æ”¾ç«¯å£

- ä»…å¼€æ”¾ä¸šåŠ¡æ‰€éœ€ç«¯å£
- å®šæœŸä½¿ç”¨å·¥å…·å®¡è®¡ç«¯å£ï¼ˆå¦‚ `nmap`, `ss`, `netstat`ï¼‰

### 2. ç½‘ç»œé˜²æŠ¤ç¤ºä¾‹

```bash
# ä½¿ç”¨ iptables é™åˆ¶ SSH ç«¯å£è®¿é—®
iptables -A INPUT -p tcp --dport 22 -s 192.168.1.0/24 -j ACCEPT
iptables -A INPUT -p tcp --dport 22 -j DROP

# å®‰è£… fail2ban é˜²æ­¢æš´åŠ›ç ´è§£
apt install fail2ban
```

### 3. å…¶ä»–åŠ å›ºå»ºè®®

- ä¿®æ”¹é»˜è®¤ç«¯å£ï¼ˆå¦‚å°† SSH çš„ 22 æ”¹ä¸º 2222ï¼‰
- ç¦ç”¨ä¸å®‰å…¨åè®®ï¼ˆå¦‚ Telnetã€FTPï¼‰
- å¯ç”¨è®¿é—®æ—¥å¿—ï¼Œé…åˆæ—¥å¿—åˆ†æå·¥å…·ï¼ˆå¦‚ fail2banã€logwatchï¼‰

## å››ã€ç«¯å£æ‰«æä¸ç›‘æ§

### å¸¸ç”¨å·¥å…·å‘½ä»¤

```bash
# æ‰«æä¸»æœºæ‰€æœ‰ç«¯å£
nmap -sS -p 1-65535 192.168.1.1

# æŸ¥çœ‹å½“å‰ç›‘å¬ç«¯å£
netstat -tulnp

# æŸ¥è¯¢ç‰¹å®šç«¯å£çš„ä½¿ç”¨æƒ…å†µ
lsof -i :80
```

### äº‘å¹³å°å®‰å…¨ç»„é…ç½®

- **AWS**ï¼šé…ç½®å®‰å…¨ç»„ï¼Œé»˜è®¤å…³é—­æ‰€æœ‰ç«¯å£
- **Azure**ï¼šä½¿ç”¨ NSGï¼ˆç½‘ç»œå®‰å…¨ç»„ï¼‰ç®¡ç†å…¥ç«™è§„åˆ™
- **é˜¿é‡Œäº‘**ï¼šé…ç½®å®‰å…¨ç»„è§„åˆ™å¼€æ”¾/å…³é—­æŒ‡å®šç«¯å£

## äº”ã€é™„å½•ï¼šç«¯å£èŒƒå›´å¯¹ç…§è¡¨

| ç«¯å£èŒƒå›´    | ç±»å‹     | ç¤ºä¾‹æœåŠ¡                      |
| ----------- | -------- | ----------------------------- |
| 0â€“1023      | ç³»ç»Ÿç«¯å£ | SSH(22)ã€HTTP(80)ã€HTTPS(443) |
| 1024â€“49151  | æ³¨å†Œç«¯å£ | MySQL(3306)ã€RDP(3389)        |
| 49152â€“65535 | åŠ¨æ€ç«¯å£ | å®¢æˆ·ç«¯å‘èµ·è¿æ¥ä½¿ç”¨çš„ä¸´æ—¶ç«¯å£  |

> ğŸ“˜ å®˜æ–¹ç«¯å£åˆ†é…åˆ—è¡¨å‚è€ƒï¼š
>  [IANA Service Name and Port Number Registry](https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml)

## å…­ã€å¸¸è§é—®é¢˜ä¸æ’æŸ¥

### é—®é¢˜ 1ï¼šç«¯å£å†²çª

```bash
# æŸ¥çœ‹è¢«å“ªä¸ªè¿›ç¨‹å ç”¨
sudo lsof -i :8080
sudo netstat -tulnp | grep 8080
```

### é—®é¢˜ 2ï¼šé˜²ç«å¢™æ‹¦æˆª

```bash
# CentOS å¼€æ”¾ç«¯å£
firewall-cmd --add-port=8080/tcp --permanent
firewall-cmd --reload

# Ubuntu ä½¿ç”¨ UFW
ufw allow 8080/tcp
```

### é—®é¢˜ 3ï¼šæœåŠ¡æœªç›‘å¬ç«¯å£

```bash
# æ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€
systemctl status nginx

# æ£€æŸ¥é…ç½®æ–‡ä»¶ä¸­ç›‘å¬è®¾ç½®
grep -i listen /etc/nginx/sites-enabled/*
```

